{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst PIXABAY_API_KEY = '49764635-55321af1e157f58385cb56e9b';\nconst PIXABAY_API_URL = 'https://pixabay.com/api/';\nconst PIXABAY_PARAMS = {\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 15,\n};\n\nexport async function getImagesByQuery(query, page) {\n  try {\n    const response = await axios.get(`${PIXABAY_API_URL}`, {\n      params: {\n        key: PIXABAY_API_KEY,\n        q: query,\n        image_type: PIXABAY_PARAMS.image_type,\n        orientation: PIXABAY_PARAMS.orientation,\n        safesearch: PIXABAY_PARAMS.safesearch,\n        page: page,\n        per_page: PIXABAY_PARAMS.per_page,\n      },\n    });\n\n    return {\n      data: response.data,\n      hits: response.data.hits,\n      totalPages: countTotalPagesTest(response),\n      page: response.config.params.page,\n    };\n  } catch (error) {\n    console.error('Error fetching data from Pixabay:', error);\n  } finally {\n  }\n}\n\nfunction countTotalPagesTest(data) {\n  const totalPages = Math.ceil(\n    data.data.totalHits / data.config.params.per_page\n  );\n  return totalPages;\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load-more');\n\n// 💡 Инициализация lightbox ДО createGallery\nconst lightbox = new SimpleLightbox('.gallery a', {});\n\nexport async function createGallery(imagesPromise) {\n  try {\n    const items = await imagesPromise;\n\n    const markup = items.hits\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `<li class=\"gallery-item\">\n                  <a href=\"${largeImageURL}\">\n                    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n                    <div class='item-footer'>\n                      <p><b>likes</b> ${likes}</p>\n                      <p><b>views</b> ${views}</p>\n                      <p><b>comments</b> ${comments}</p>\n                      <p><b>downloads</b> ${downloads}</p>\n                    </div>\n                  </a>\n                </li>`;\n        }\n      )\n      .join('');\n\n    gallery.insertAdjacentHTML('beforeend', markup);\n\n    // Обновление lightbox после вставки разметки\n    lightbox.refresh();\n\n    if (items.page === items.totalPages) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n      });\n    }\n  } catch (error) {\n    console.error('Error creating gallery:', error);\n    iziToast.error({\n      message: 'Something went wrong while creating the gallery.',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  }\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('hidden-loader');\n}\nexport function hideLoader() {\n  loader.classList.add('hidden-loader');\n}\nexport function showLoadMoreButton() {\n  loadMore.classList.remove('load-more-hidden');\n}\nexport function hideLoadMoreButton() {\n  loadMore.classList.add('load-more-hidden');\n}\n","//У файлі main.js напиши всю логіку роботи додатка. Виклики нотифікацій iziToast, усі перевірки на довжину масиву в отриманій відповіді та логіку прокручування сторінки (scroll) робимо саме в цьому файлі. Імпортуй в нього функції із файлів pixabay-api.js та render-functions.js та викликай їх у відповідний момент.\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  clearGallery,\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  showLoader,\n  showLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more');\nlet inputValue = null;\nlet page = null;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  page = 1;\n  inputValue = form.elements['search-text'].value.trim();\n  clearGallery();\n\n  if (inputValue === '') {\n    iziToast.error({\n      message: 'Please enter a search query!',\n      position: 'topRight',\n      timeout: 2000,\n    });\n    return;\n  }\n\n  showLoader();\n\n  try {\n    const response = await getImagesByQuery(inputValue, page);\n\n    if (!response.data.hits.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 2000,\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    createGallery(response);\n    showLoadMoreButton();\n  } catch (error) {\n    iziToast.error({\n      message: 'Error fetching data from Pixabay',\n      position: 'topCenter',\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n});\n\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n\nasync function onLoadMoreBtnClick() {\n  page += 1;\n  const galery_item = document.querySelector('.gallery-item');\n  const galery_item_height = galery_item.getBoundingClientRect().height;\n\n  const loaderWrapper = document.querySelector('.loader-wraper');\n  const gallery = document.querySelector('.gallery');\n  gallery.insertAdjacentElement('afterend', loaderWrapper);\n\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(inputValue, page);\n    createGallery(data);\n\n    requestAnimationFrame(() => {\n      const galery_item = document.querySelector('.gallery-item');\n      const galery_item_height = galery_item.getBoundingClientRect().height;\n\n      window.scrollBy({\n        left: 0,\n        top: galery_item_height * 2,\n        behavior: 'smooth',\n      });\n    });\n  } catch (error) {\n    iziToast.error({\n      message: 'Error fetching data from Pixabay',\n      position: 'topCenter',\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n  }\n}\n"],"names":["PIXABAY_API_KEY","PIXABAY_API_URL","PIXABAY_PARAMS","getImagesByQuery","query","page","response","axios","countTotalPagesTest","error","data","gallery","loader","loadMore","lightbox","SimpleLightbox","createGallery","imagesPromise","items","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","hideLoadMoreButton","iziToast","clearGallery","showLoader","hideLoader","showLoadMoreButton","form","loadMoreBtn","inputValue","event","onLoadMoreBtnClick","loaderWrapper","galery_item_height"],"mappings":"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"}