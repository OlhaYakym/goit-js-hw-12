{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst PIXABAY_API_KEY = '49764635-55321af1e157f58385cb56e9b';\nconst PIXABAY_API_URL = 'https://pixabay.com/api/';\nconst PIXABAY_PARAMS = {\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 15,\n};\n\nexport async function getImagesByQuery(query, page) {\n  try {\n    const response = await axios.get(`${PIXABAY_API_URL}`, {\n      params: {\n        key: PIXABAY_API_KEY,\n        q: query,\n        image_type: PIXABAY_PARAMS.image_type,\n        orientation: PIXABAY_PARAMS.orientation,\n        safesearch: PIXABAY_PARAMS.safesearch,\n        page: page,\n        per_page: PIXABAY_PARAMS.per_page,\n      },\n    });\n\n    return {\n      data: response.data,\n      hits: response.data.hits,\n      totalPages: countTotalPagesTest(response),\n      page: response.config.params.page,\n    };\n  } catch (error) {\n    console.error('Error fetching data from Pixabay:', error);\n  } finally {\n  }\n}\n\nfunction countTotalPagesTest(data) {\n  const totalPages = Math.ceil(\n    data.data.totalHits / data.config.params.per_page\n  );\n  return totalPages;\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load-more');\n\nexport async function createGallery(imagesPromise) {\n  try {\n    const items = await imagesPromise;\n    const markup = items.hits\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `<li class=\"gallery-item\">\n                  <a href=\"${largeImageURL}\">\n                    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n                    <div class='item-footer'>\n                      <p><b>likes</b> ${likes}</p>\n                      <p><b>views</b> ${views}</p>\n                      <p><b>comments</b> ${comments}</p>\n                      <p><b>downloads</b> ${downloads}</p>\n                    </div>\n                  </a>\n                </li>`;\n        }\n      )\n      .join('');\n\n    gallery.insertAdjacentHTML('beforeend', markup);\n    if (items.page === items.totalPages) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n      });\n    }\n    lightbox.refresh();\n  } catch (error) {\n    console.error('Error creating gallery:', error);\n  }\n}\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('hidden-loader');\n}\nexport function hideLoader() {\n  loader.classList.add('hidden-loader');\n}\nexport function showLoadMoreButton() {\n  loadMore.classList.remove('load-more-hidden');\n}\nexport function hideLoadMoreButton() {\n  loadMore.classList.add('load-more-hidden');\n}\nconst lightbox = new SimpleLightbox('.gallery a', {});\n","//У файлі main.js напиши всю логіку роботи додатка. Виклики нотифікацій iziToast, усі перевірки на довжину масиву в отриманій відповіді та логіку прокручування сторінки (scroll) робимо саме в цьому файлі. Імпортуй в нього функції із файлів pixabay-api.js та render-functions.js та викликай їх у відповідний момент.\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  clearGallery,\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  showLoader,\n  showLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more');\nlet inputValue = null;\nlet page = null;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  page = 1;\n  inputValue = form.elements['search-text'].value;\n  clearGallery();\n  if (inputValue === '') {\n    iziToast.error({\n      message: 'Please enter a search inputValue!',\n      position: 'topRight',\n      timeout: 2000,\n    });\n    return;\n  }\n  showLoader();\n  const data = getImagesByQuery(inputValue, page);\n  // const totalPages = await countTotalPages(data);\n  // console.log('total pages', totalPages);\n  // if (page === totalPages) {\n  //   hideLoadMoreButton();\n  // }\n  // console.log('DATA', await data);\n  data\n    .then(response => {\n      // console.log('response!!!', response);\n      if (response.data.hits.length === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search inputValue. Please try again!',\n          position: 'topRight',\n          timeout: 2000,\n        });\n        return;\n      }\n      // console.log('response_main', response);\n      createGallery(response);\n      showLoadMoreButton();\n    })\n    .catch(() => {\n      iziToast.error({\n        message: 'Error fetching data from Pixabay',\n        position: 'topCenter',\n        timeout: 3000,\n      });\n    })\n    .finally(() => {\n      hideLoader();\n    });\n  form.reset();\n  \n});\n\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n\nasync function onLoadMoreBtnClick() {\n  page += 1;\n  // console.log('click');\n  const galery_item = document.querySelector('.gallery-item');\n  const galery_item_height = galery_item.getBoundingClientRect().height;\n  // console.log('galery_item_height', galery_item_height);\n  \n  // Перемещаем loader-wraper после галереи\n  const loaderWrapper = document.querySelector('.loader-wraper');\n  const gallery = document.querySelector('.gallery');\n  gallery.insertAdjacentElement('afterend', loaderWrapper);\n\n  showLoader();\n  try {\n    const data = await getImagesByQuery(inputValue, page);\n    createGallery(data);\n\n    requestAnimationFrame(() => {\n      const galery_item = document.querySelector('.gallery-item');\n      const galery_item_height = galery_item.getBoundingClientRect().height;\n\n      window.scrollBy({\n        left: 0,\n        top: galery_item_height * 2,\n        behavior: 'smooth',\n      });\n    });\n    \n  } catch (error) {\n    iziToast.error({\n      message: 'Error fetching data from Pixabay',\n      position: 'topCenter',\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n   \n  }\n}"],"names":["PIXABAY_API_KEY","PIXABAY_API_URL","PIXABAY_PARAMS","getImagesByQuery","query","page","response","axios","countTotalPagesTest","error","data","gallery","loader","loadMore","createGallery","imagesPromise","items","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","hideLoadMoreButton","iziToast","lightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","SimpleLightbox","form","loadMoreBtn","inputValue","event","onLoadMoreBtnClick","loaderWrapper","galery_item_height"],"mappings":"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"}